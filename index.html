<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Post-Quantum Crypto Portfolio</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .slider-container {
      max-width: 600px;
      width: 100%;
    }

    .crypto-slider {
      margin: 12px 0;
    }

    .crypto-slider label {
      display: inline-block;
      width: 100px;
    }

    .summary {
      margin: 40px 0 20px;
      font-size: 1.2em;
      font-weight: bold;
    }

    .cta {
      background: #f9a825;
      padding: 14px 24px;
      color: black;
      font-weight: bold;
      border: none;
      border-radius: 30px;
      cursor: pointer;
      text-decoration: none;
    }

    canvas {
      max-width: 400px;
      margin-top: 30px;
    }
  </style>
</head>
<body>
  <h2>What's in Your Crypto Portfolio?</h2>
  <p>Adjust the sliders to match the % of each coin you hold (total must equal 100%).</p>

  <div class="slider-container" id="sliders">
    <!-- Sliders inserted here by JS -->
  </div>

  <p id="totalDisplay">Total: 0%</p>

  <div class="summary" id="pqMessage">87% of your crypto portfolio is not post-quantum secure.</div>
  <a class="cta" href="https://theqrl.org" target="_blank">Learn More About QRL</a>

  <canvas id="portfolioChart"></canvas>

  <script>
    const coins = [
      "Bitcoin", "Ethereum", "USDC", "Solana", "DOGE",
      "Litecoin", "Polkadot", "Monero", "Other", "QRL"
    ];

    const colors = [
      "#f7931a", "#627eea", "#2775ca", "#00ffb3", "#c2a633",
      "#bebebe", "#e6007a", "#ff6600", "#888888", "#ffaa00"
    ];

    const slidersDiv = document.getElementById("sliders");
    const totalDisplay = document.getElementById("totalDisplay");
    const pqMessage = document.getElementById("pqMessage");

    const inputs = {};

    coins.forEach((coin, i) => {
      const div = document.createElement("div");
      div.className = "crypto-slider";

      const label = document.createElement("label");
      label.innerText = coin;

      const input = document.createElement("input");
      input.type = "range";
      input.min = 0;
      input.max = 100;
      input.value = 0;
      input.step = 1;
      input.id = coin;

      const span = document.createElement("span");
      span.id = `${coin}-val`;
      span.innerText = "0%";

      input.addEventListener("input", () => {
        span.innerText = input.value + "%";
        updateChart();
      });

      inputs[coin] = input;

      div.appendChild(label);
      div.appendChild(input);
      div.appendChild(span);
      slidersDiv.appendChild(div);
    });

    const ctx = document.getElementById("portfolioChart").getContext("2d");
    const chart = new Chart(ctx, {
      type: "pie",
      data: {
        labels: coins,
        datasets: [{
          data: coins.map(() => 0),
          backgroundColor: colors,
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: {
            position: 'right'
          }
        }
      }
    });

    function updateChart() {
      let total = 0;
      let pqSecure = 0;

      const data = coins.map((coin, i) => {
        const val = parseInt(inputs[coin].value) || 0;
        total += val;
        if (coin === "QRL") pqSecure += val;
        return val;
      });

      if (total > 100) {
        totalDisplay.innerText = `⚠️ Total: ${total}% (must be 100% or less)`;
        totalDisplay.style.color = "red";
      } else {
        totalDisplay.innerText = `Total: ${total}%`;
        totalDisplay.style.color = "black";
      }

      const pqInsecure = 100 - pqSecure;
      pqMessage.innerText = `${pqInsecure}% of your crypto portfolio is not post-quantum secure.`;

      chart.data.datasets[0].data = data;
      chart.update();
    }
  </script>
</body>
</html>
